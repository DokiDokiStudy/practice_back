---
title: "7.4 도커 컴포즈로 애플리케이션 설정값 지정하기"
categoryPath:
  - "Docker"
  - "7장 도커 컴포즈로 분산 애플리케이션 실행하기"
  - "7.4 도커 컴포즈로 애플리케이션 설정값 지정하기"
authorNick: "관리자"
createdAt: "2025-08-27"
updateMode: "upsert"
---

# 7.4 도커 컴포즈로 애플리케이션 설정값 지정하기

## 개요

도커 컴포즈를 사용하면 애플리케이션의 설정값을 효과적으로 관리하고 환경에 맞게 조정할 수 있다. 이번 장에서는 애플리케이션 설정값을 컴포즈 파일에서 지정하고 관리하는 방법을 알아본다.

## 상세 내용

### 외부 데이터베이스 연결 예시

이전 예시에서는 데이터 저장을 위해 볼륨을 사용했지만, 이번에는 별도의 데이터베이스를 사용하는 방법을 알아보자.

```yaml
services:
  todo-db:
    image: diamol/postgres:11.5
    ports:
      - "5433:5432"
    networks:
      - app-net

  todo-web:
    image: diamol/ch06-todo-list
    ports:
      - "8020:80"
    environment:
      - Database:Provider=Postgres
    depends_on:
      - todo-db
    networks:
      - app-net
    secrets:
      - source: postgres-connection
        target: /app/config/secret.json

networks:
  app-net:

secrets:
  postgres-connection:
    file: ./config/postgres-connection.json
```

### 새로운 설정 옵션 소개

#### 1. environment (환경 변수)

`environment` 필드는 컨테이너 내부에서 사용될 환경 변수를 정의한다:

- 키-값 쌍 형태로 지정 가능
- 애플리케이션의 동작을 제어하는 데 사용
- 예시: `Database:Provider=Postgres`는 애플리케이션에게 PostgreSQL 데이터베이스를 사용하도록 지시

#### 2. secrets (비밀값)

`secrets` 필드는 민감한 정보를 컨테이너에 안전하게 전달하는 방법을 정의한다:

- 컨테이너 내부의 지정된 경로에 파일로 마운트됨
- 데이터베이스 연결 문자열, API 키, 인증서 등 민감한 정보 전달에 적합
- 컨테이너 플랫폼(Docker Swarm, Kubernetes)에서는 암호화되어 저장됨

예시에서는 `postgres-connection`이라는 비밀값이 컨테이너 내부의 `/app/config/secret.json` 파일로 마운트된다.

### 설정값 분리의 이점

컴포즈 파일에서 애플리케이션 설정값을 분리하면 다음과 같은 이점이 있다:

1. **동일 이미지의 다양한 활용**:
   - 같은 이미지를 다른 설정으로 실행 가능
   - 환경별(개발, 테스트, 운영)로 다른 설정 적용 가능

2. **명시적인 설정 관리**:
   - 모든 설정이 코드로 관리됨(Infrastructure as Code)
   - 버전 관리 시스템으로 설정 변경 이력 추적 가능

3. **환경별 구성 최적화**:
   - 개발 환경: 디버깅 활성화, 로컬 포트 노출
   - 테스트 환경: 테스트 데이터베이스 연결
   - 운영 환경: 보안 강화, 최적의 성능 설정

### 애플리케이션과 설정값의 분리

도커의 핵심적인 장점 중 하나는 애플리케이션과 설정값을 명확히 분리할 수 있다는 점이다:

1. **이미지 빌드 프로세스**:
   - 애플리케이션 코드로부터 이미지 빌드
   - 빌드 파이프라인을 통한 자동화된 검증
   - 모든 환경에서 동일한 이미지 사용

2. **환경별 설정 적용**:
   - 컴포즈 파일에서 환경변수 정의
   - 바인드 마운트로 설정 파일 제공
   - 비밀값을 통한 민감 정보 전달

3. **결과적 이점**:
   - "한 번 빌드, 어디서나 실행" 원칙 준수
   - 개발-테스트-운영 환경 간 일관성 유지
   - 설정 변경만으로 애플리케이션 동작 조정 가능

### 실제 활용 시나리오

#### 개발 환경 컴포즈 파일

```yaml
services:
  todo-web:
    image: diamol/ch06-todo-list
    ports:
      - "8020:80"
    environment:
      - Database:Provider=Sqlite
```

#### 운영 환경 컴포즈 파일

```yaml
services:
  todo-web:
    image: diamol/ch06-todo-list
    ports:
      - "80:80"
    environment:
      - Database:Provider=Postgres
    secrets:
      - postgres-connection
```

### 결론

도커 컴포즈를 사용한 설정값 관리는 애플리케이션 배포의 유연성과 일관성을 크게 향상시킨다. 설정과 코드를 분리함으로써 동일한 애플리케이션 이미지를 다양한 환경에서 서로 다른 설정으로 실행할 수 있으며, 이는 현대적인 애플리케이션 개발 및 배포 파이프라인의 핵심 요소다.

도커 컴포즈는 이러한 설정값 관리를 위한 다양한 옵션(환경 변수, 비밀값, 볼륨 등)을 제공하여 개발자가 애플리케이션 구성을 효과적으로 제어할 수 있게 해준다.