---
title: '도커 이미지와 이미지 레이어 이해하기'
categoryPath:
  - 'Docker'
  - '3장 도커 이미지 만들기'
  - '3.4 도커 이미지와 이미지 레이어 이해하기'
authorNick: '관리자'
createdAt: '2025-08-10'
updateMode: 'upsert'
---

# 도커 이미지와 이미지 레이어 이해하기

도커 이미지에는 패키징한 모든 파일들이 들어있는데 이들 파일들은 컨테이너의 파일 시스템을 형성하고 메타 데이터 역시 가지고 있습니다. 이러한 정보들은 이미지를 구성하는 레이어들이 빌드될 때에 어떤 식으로 빌드가 되었고, 어떤 명령어에 의해 빌드됐는지도 알수 있습니다.

```
docker image history web-ping
IMAGE          CREATED          CREATED BY                                SIZE      COMMENT
b29fb0999b88   18 minutes ago   CMD ["npm" "run" "start"]                 0B        buildkit.dockerfile.v0
<missing>      18 minutes ago   EXPOSE map[3000/tcp:{}]                   0B        buildkit.dockerfile.v0
<missing>      18 minutes ago   COPY /app/tsconfig*.json ./ # buildkit    16.4kB    buildkit.dockerfile.v0
```

여기에서 **created by** 항목은 해당 레이어를 구성한 Dockerfile 스크립트의 인스트럭션으로 이미지와 1:1 관계를 갖습니다. 도커 이미지는 이미지 레이어가 모인 논리적 대상이고, 레이어는 도커 엔진의 캐시에 물리적으로 저장된 파일입니다. 이러한 ``이미지 레이어 파일``은 여러 이미지와 컨테이너에서 **공유**되기에 만약 Node.js 애플리케이션이 실행되는 컨테이너를 여러개 실행할때에 Node.js 런타임이 들어있는 이미지 레이어는 공유되어 사용됩니다.

> 이미지 내에서 동일하게 사용되는 레이어들이 많으면 많을수록 애플리케이션이 실행될때에 필요한 나머지 레이어들이 차지하는 용량 자체는 줄어들게 됩니다.

```
docker image ls
REPOSITORY                     TAG       IMAGE ID       CREATED          SIZE
web-ping                       latest    b29fb0999b88   34 minutes ago   806MB
diamol/ch02-hello-diamol-web   latest    fe5a4c954fe2   4 years ago      80.5MB
diamol/ch03-web-ping           latest    2f2dce710a7f   5 years ago      118MB
diamol/node                    latest    dfee522acebd   6 years ago      118MB
```

위에 다운받은 이미지들의 리스트 안에서 ``web-ping``, ``diamol/ch03-web-ping``, ``diamol/node``이 세가지 이미지들은 모두 Node.js 기반 레이어를 공유하고 여기에 나와있는 용량은 이미지의 논리적 용량으로 실제 용량을 확인하려면 ``docker system df``명령어를 사용하면 됩니다.

```
docker system df
TYPE            TOTAL     ACTIVE    SIZE      RECLAIMABLE
Images          4         1         3.707GB   2.901GB (78%)
Containers      4         0         86.02kB   86.02kB (100%)
Local Volumes   0         0         0B        0B
Build Cache     54        0         3.838GB   3.838GB
```

다만 이렇게 레이어가 여러 곳에서 공유될 경우에 공유된 레이어가 수정되게 되면 그 수정이 레이어를 사용하는 다른 이미지에도 영향을 미칠 수 있습니다. 그렇기 때문에 도커는 이미지 레이어를 읽기 전용으로 만들어 두어 문제를 방지합니다. 이미지를 빌드할 때 생기는 레이어는 재사용할 수는 있어도 수정은 불가능합니다. 